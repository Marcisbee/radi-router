{"version":3,"file":"radi-router.js","sources":["../src/index.js"],"sourcesContent":["export const version = '0.5.0';\n\n// Pass routes to initiate things\nconst RadiRouter = ({\n    h,\n    l,\n    patch,\n    Service,\n    Store,\n    customAttribute,\n  }, routes) => {\n  let current = {};\n\n  const COLON = ':'.charCodeAt(0);\n  const SLASH = '/'.charCodeAt(0);\n  var cr, crg, lr, ld;\n\n  const parseRoute = route => {\n    var parts = route.split('/'),\n      end = [],\n      p = [];\n    for (var i = 0; i < parts.length; i++) {\n      if (COLON === parts[i].charCodeAt(0)) {\n        end.push('([^/]+?)');\n        p.push(parts[i].substr(1));\n      } else if (parts[i] !== '') {\n        end.push(parts[i]);\n      }\n    }\n    return [new RegExp('^/' + end.join('/') + '(?:[/])?(?:[?&].*)?$', 'i'), p];\n  };\n\n  const parseAllRoutes = arr => {\n    var len = arr.length,\n      ret = new Array(len);\n    for (var i = len - 1; i >= 0; i--) {\n      ret[i] = parseRoute(arr[i]);\n    }\n    return ret;\n  };\n\n  const renderError = number => {\n    return current.config.errors[number]();\n  };\n\n  const writeUrl = url => {\n    window.location.hash = url;\n    return true;\n  };\n\n  const extractChildren = routes => {\n    let children = routes;\n    for (let child in routes) {\n      if (routes.hasOwnProperty(child) && routes[child].children) {\n        let extracted = extractChildren(routes[child].children);\n        for (var nn in extracted) {\n          if (extracted.hasOwnProperty(nn)) {\n            children[child + nn] = extracted[nn];\n          }\n        }\n      }\n    }\n    return children;\n  };\n\n  const getRoute = curr => {\n    if (lr === curr) return ld;\n    console.log(current, routes)\n    if (!cr) cr = Object.keys(current.routes);\n    if (!crg) crg = parseAllRoutes(cr);\n    var cahnged = false;\n\n    for (var i = 0; i < crg.length; i++) {\n      if (crg[i][0].test(curr)) {\n        ld = new Route(curr, crg[i], current.routes, cr[i]);\n        cahnged = true;\n        break;\n      }\n    }\n\n    lr = curr;\n    return !cahnged ? { key: null } : ld;\n  };\n\n  class Route {\n    constructor(curr, match, routes, key) {\n      const query = curr\n        .split(/[\\?\\&]/)\n        .slice(1)\n        .map(query => query.split('='))\n        .reduce(\n          (acc, key) =>\n            Object.assign(acc, {\n              [key[0]]: key[1]\n            }),\n          {}\n        );\n      var m = curr.match(match[0]);\n      this.path = curr;\n      this.key = key;\n      this.query = query;\n      this.cmp = routes[key] || {};\n      this.params = this.cmp.data || {};\n      for (var i = 0; i < match[1].length; i++) {\n        this.params[match[1][i]] = m[i + 1];\n      }\n    }\n  }\n\n  const combineTitle = (...args) => (\n    args.reduce((a, v) => (v ? a.concat(v) : a), [])\n  );\n\n\n  const getHash = () => location.hash.substr(1) || '/';\n\n  const hashChange = new Subscribe(window).on('hashchange', e => ({ hash: getHash() }));\n\n  // const locationState = new Subscribe(window).on('popstate', e => ({\n  //   url: document.location.pathname,\n  //   state: e.state,\n  // }))\n\n  const RouterStore = new Store({\n    route: hashChange({ hash: getHash() }).map(({hash}) => hash),\n    params: {},\n    query: {},\n    current: {\n      title: null,\n      tags: [],\n      meta: {},\n    },\n    // location: locationState({ url: null, state: null }),\n  })\n  .map((store, oldStore = {}) => {\n    var loc = window.location.hash.substr(1) || '/';\n    var a = getRoute(loc) || {};\n\n    // console.log('[radi-router] Route change', a);\n\n    window.scrollTo(0, 0);\n\n    // this.resolve(this.inject(a.key || '', this.state.active))\n\n    let title = a.cmp && a.cmp.title;\n    const reHashed = store.route.split('#');\n\n    return {\n      route: reHashed[0],\n      hash: reHashed[1],\n      last: store.active,\n      location: loc,\n      params: a.params || {},\n      query: a.query || {},\n      active: a.key || '',\n      current: {\n        title: (typeof title === 'object') ? title : {\n          text: title,\n        } || null,\n        tags: (a.cmp && a.cmp.tags) || [],\n        meta: (a.cmp && a.cmp.meta) || {},\n      },\n    };\n  });\n\n  customAttribute('href', (e, value) => {\n    if (value[0] === '#') return RouterStore(({route}) => (\n      '#' + route + value\n    ));\n\n    return '#' + value;\n  }, {\n    allowedTags: ['a'],\n    addToElement: true,\n  });\n\n  const routeChange = ({route, last}, newState) => ({\n    ...newState,\n    last,\n    route,\n  })\n\n  function evalFn(fn) {\n    if (typeof fn === 'function') return evalFn(fn());\n    return fn;\n  }\n\n  // Triggers when route is changed\n  function extractComponent(active, last) {\n    // Route is not yet ready\n    // For the future, maybe show cached page or default screen\n    // or loading placeholder if time between this and next request\n    // is too long\n    if (active === null && typeof last === 'undefined') return;\n\n    // const { active, last } = this.state\n    const RouteComponent = current.routes[active];\n    const WillRender =\n      typeof RouteComponent === 'object'\n        ? RouteComponent.component\n        : RouteComponent;\n\n    // Route not found or predefined error\n    if (\n      (typeof WillRender === 'undefined' ||\n        typeof WillRender === 'number' ||\n        !WillRender) &&\n      typeof RouteComponent === 'undefined'\n    )\n      return renderError(WillRender || 404);\n\n    // Plain redirect\n    if (typeof RouteComponent.redirect === 'string')\n      return writeUrl(RouteComponent.redirect);\n\n    // Check if has any guards to check\n    const guards = [\n      current.before || null,\n      RouteComponent.before || null,\n    ].filter(guard => typeof guard === 'function');\n\n    if (guards.length > 0) {\n      const checkGuard = (resolve, reject) => {\n        const popped = guards.pop();\n\n        if (typeof popped !== 'function') {\n          return resolve(WillRender);\n        }\n\n        return popped(active, last, act => {\n          // Render\n          if (typeof act === 'undefined' || act === true) {\n            if (guards.length > 0) {\n              return checkGuard(resolve, reject);\n            } else {\n              return resolve(WillRender);\n            }\n          }\n\n          if (act) {\n            if (guards.length > 0) {\n              return checkGuard(resolve, reject);\n            } else {\n              return resolve(act);\n            }\n          }\n\n          // Redirect\n          // if (typeof act === 'string' && act.charCodeAt(0) === SLASH) {\n          //   reject();\n          //   return writeUrl(act);\n          // }\n\n          // Restricted\n          return resolve(renderError(403));\n        });\n      };\n\n      // return h('div', {}, h('await', {src: new Promise(checkGuard)}));\n      return new Promise(checkGuard);\n    }\n\n    // Route is plain text/object\n    return WillRender;\n  }\n\n  // Components\n  function RouterBody({ placeholder, waitMs }) {\n    // const self = this;\n    // this.onMount = (e) => {\n    //\n    //   console.log(e, e.parentElement)\n    //   patch(e.parentElement, RouterStore(({active}) => extractComponent(active)), null, 0, e);\n    // };\n    // return h('router');\n\n    // return h('router', {}, [\n    //   active,\n    // ]);\n    // return h(new Promise(e => e(RouteComponent.component)));\n    return RouterStore(({ active, route }) => {\n      const src = new Promise(resolve => {\n        const evaluated = evalFn(extractComponent(route));\n\n        if (evaluated instanceof Promise) {\n          evaluated.then(e => resolve(evalFn(e)));\n        } else {\n          resolve(evaluated);\n        }\n      });\n      return h('await', { src, placeholder, waitMs });\n    });\n  }\n\n  const titleState = new Store({\n    prefix: null,\n    text: null,\n    suffix: null,\n    seperator: ' | ',\n  });\n\n  const setPrefix = (state, prefix) => ({prefix});\n  const setSuffix = (state, suffix) => ({suffix});\n  const setText = (state, text) => ({text});\n  const setSeperator = (state, seperator) => ({seperator});\n\n  class Title {\n    constructor() {\n      this.state = titleState;\n    }\n\n    setPrefix(prefix) {\n      return titleState.dispatch(setPrefix, prefix);\n    }\n\n    setSuffix(suffix) {\n      return titleState.dispatch(setSuffix, suffix);\n    }\n\n    set(text) {\n      return titleState.dispatch(setText, text);\n    }\n\n    setSeperator(seperator) {\n      return titleState.dispatch(setSeperator, seperator);\n    }\n\n    onUpdate() {\n      let titleConfig = this.$router.getTitle() || {};\n\n      let pefix = (routes.title && routes.title.prefix) || this.state.prefix;\n      let text = titleConfig.text || (routes.title && routes.title.text) || this.state.text;\n      let suffix = (routes.title && routes.title.suffix) || this.state.suffix;\n\n      let title = combineTitle(\n        pefix,\n        text,\n        suffix\n      ).join(this.state.seperator);\n\n      if (title && document.title !== title) {\n        document.title = title;\n      }\n\n      if (this.state.text && text !== this.state.text) {\n        this.set(null);\n      }\n    }\n  }\n\n  // function Link(props) {\n  //   const {\n  //     href = '/',\n  //     active = 'active',\n  //     core = false,\n  //     children,\n  //   } = props;\n\n  //   return (\n  //     h('a',\n  //       {\n  //         ...props,\n  //         href,\n  //         class: [\n  //           (active === to || (this.state.core && new RegExp('^' + to).test(active)))\n  //             && this.state.active\n  //           props.class, active],\n  //       },\n  //       children,\n  //     )\n  //   )\n  // }\n\n  // class Link extends Component {\n  //   constructor(...args) {\n  //     super(...args);\n  //     this.state = {\n  //       to: '/',\n  //       active: 'active',\n  //       core: false,\n  //       class: '',\n  //       id: null,\n  //       title: null,\n  //     };\n  //   }\n  //   view() {\n  //     return r(\n  //       'a',\n  //       {\n  //         href: l(this, 'to').process(url => '#'.concat(url)),\n  //         class: l(this, 'to').process(to =>\n  //           l(this.$router, 'active').process(active =>\n  //             l(this, 'class').process(cls => ([\n  //               (active === to || (this.state.core && new RegExp('^' + to).test(active)))\n  //                 && this.state.active,\n  //               cls\n  //             ]))\n  //           )\n  //         ),\n  //         id: l(this, 'id'),\n  //         title: l(this, 'title'),\n  //       },\n  //       ...this.children\n  //     );\n  //   }\n  // }\n\n  const before = routes.beforeEach;\n  const after = routes.afterEach;\n\n  const getError = (code, fallback) => {\n    let error = routes.errors && routes.errors[code];\n\n    if (error) {\n      return typeof error === 'function' ? error : () => error;\n    }\n\n    return fallback;\n  };\n\n  current = {\n    config: {\n      errors: {\n        404: getError(404, () => h('div', {}, 'Error 404: Not Found')),\n        403: getError(403, () => h('div', {}, 'Error 403: Forbidden')),\n      },\n    },\n    before,\n    after,\n    routes: extractChildren(routes.routes),\n    write: writeUrl,\n    // Link,\n    Router: RouterBody,\n  };\n\n  // Initiates router store\n  Service.add('routerStore', () => RouterStore);\n\n  // Initiates title plugin\n  Service.add('Title', () => new Title());\n\n  // Initiates router body component\n  Service.add('Router', () => RouterBody);\n\n  return current;\n};\n\nif (window) window.RadiRouter = RadiRouter;\nexport default RadiRouter;\n"],"names":["const","let"],"mappings":"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"}