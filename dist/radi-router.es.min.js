var version='0.5.0',RadiRouter=function(t,n){var r=t.h,e=t.Subscribe,u=t.Service,o=t.Store,i=t.customAttribute;n===void 0&&(n=[]);n||console.warn('[Radi:Router] Routes should be set as a second parameter');var c={},f=58;47;var s,a,l,p,h=function(t){var n=t.split('/'),r=[],e=[];for(var u=0;u<n.length;u++)f===n[u].charCodeAt(0)?(r.push('([^/]+?)'),e.push(n[u].substr(1))):n[u]!==''&&r.push(n[u]);return[new RegExp('^/'+r.join('/')+'(?:[/])?(?:[?&].*)?$','i'),e]},d=function(t){var n=t.length,r=new Array(n);for(var e=n-1;e>=0;e--)r[e]=h(t[e]);return r},m=function(t){return c.config.errors[t]()},g=function(t){window.location.hash=t;return!0},b=function(t){var n=t;for(var r in t){if(t.hasOwnProperty(r)&&t[r].children){var e=b(t[r].children);for(var u in e)e.hasOwnProperty(u)&&(n[r+u]=e[u])}}return n},w=function(t){if(l===t){return p}s||(s=Object.keys(c.routes));a||(a=d(s));var n=!1;for(var r=0;r<a.length;r++){if(a[r][0].test(t)){p=new y(t,a[r],c.routes,s[r]);n=!0;break}}l=t;return!n?{key:null}:p},y=function(t,n,r,e){var u=this,o=t.split(/[\?\&]/).slice(1).map(function(t){return t.split('=')}).reduce(function(t,n){var r;return Object.assign(t,(r={}, r[n[0]]=n[1], r))},{}),i=t.match(n[0]);this.path=t;this.key=e;this.query=o;this.cmp=r[e]||{};this.params=this.cmp.data||{};for(var c=0;c<n[1].length;c++)u.params[n[1][c]]=i[c+1]},x=function(){var t=[],n=arguments.length;while(n--)t[n]=arguments[n];return(t.reduce(function(t,n){return n?t.concat(n):t},[]))},j=function(){return location.hash.substr(1)||'/'},S=new e(window).on('hashchange',function(t){return({hash:j()})}),v=new o({route:S({hash:j()}).map(function(t){var n=t.hash;return n}),params:{},query:{},current:{title:null,tags:[],meta:{}}}).map(function(t,n){n===void 0&&(n={});var r=window.location.hash.substr(1)||'/',e=w(r)||{};window.scrollTo(0,0);var u=e.cmp&&e.cmp.title,o=t.route.split('#');return{route:o[0],hash:o[1],last:t.active,location:r,params:e.params||{},query:e.query||{},active:e.key||'',current:{title:typeof u==='object'?u:{text:u}||null,tags:e.cmp&&e.cmp.tags||[],meta:e.cmp&&e.cmp.meta||{}}}});i('href',function(t,n){if(n[0]==='#'){return v(function(t){var r=t.route;return'#'+r+n})}return'#'+n},{allowedTags:['a'],addToElement:!0});function A(t){if(typeof t==='function'){return A(t())}if(typeof t==='object'&&t.default){return A(t.default)}return t}function k(t,n){var r=A(t);r instanceof Promise?r.then(function(t){return k(t,n)}):n(r)}function E(t,n){if(t===null&&typeof n==='undefined'){return}var r=c.routes[t],e=typeof r==='object'?r.component:r;if((typeof e==='undefined'||typeof e==='number'||!e)&&typeof r==='undefined'){return m(e||404)}if(typeof r.redirect==='string'){return g(r.redirect)}var u=[c.before||null,r.before||null].filter(function(t){return typeof t==='function'});if(u.length>0){var o=function(r,i){var c=u.pop();if(typeof c!=='function'){return r(e)}return c(t,n,function(t){if(typeof t==='undefined'||t===!0){if(u.length>0){return o(r,i)}else{return r(e)}}if(t){if(u.length>0){return o(r,i)}else{return r(t)}}return r(m(403))})};return new Promise(o)}return e}function R(t){var n=t.placeholder,e=t.waitMs;return v(function(t){t.active;var u=t.route,o=new Promise(function(t){var n=A(E(u));n instanceof Promise?n.then(function(n){k(n,t)}):t(n)});return r('await',{src:o,placeholder:n,waitMs:e})})}var C=new o({prefix:null,text:null,suffix:null,seperator:' | '}),P=function(t,n){return({prefix:n})},T=function(t,n){return({suffix:n})},q=function(t,n){return({text:n})},O=function(t,n){return({seperator:n})},$=function(){this.state=C};$.prototype.setPrefix=function(t){return C.dispatch(P,t)};$.prototype.setSuffix=function(t){return C.dispatch(T,t)};$.prototype.set=function(t){return C.dispatch(q,t)};$.prototype.setSeperator=function(t){return C.dispatch(O,t)};$.prototype.onUpdate=function(){var t=this.$router.getTitle()||{},r=n.title&&n.title.prefix||this.state.prefix,e=t.text||n.title&&n.title.text||this.state.text,u=n.title&&n.title.suffix||this.state.suffix,o=x(r,e,u).join(this.state.seperator);o&&document.title!==o&&(document.title=o);this.state.text&&e!==this.state.text&&this.set(null)};var F=n.beforeEach,M=n.afterEach,N=function(t,r){var e=n.errors&&n.errors[t];if(e){return typeof e==='function'?e:function(){return e}}return r};c={config:{errors:{404:N(404,function(){return r('div',{},'Error 404: Not Found')}),403:N(403,function(){return r('div',{},'Error 403: Forbidden')})}},before:F,after:M,routes:b(n.routes),write:g,Router:R};u.add('routerStore',function(){return v});u.add('Title',function(){return new $});u.add('Router',function(){return R});return c};window&&(window.RadiRouter=RadiRouter);export default RadiRouter;export { version }