var version='0.5.0',RadiRouter=function(t,n){var e=t.h,r=t.Action,u=t.Await,o=t.Event,i=t.Merge,c=t.Service,l=t.Store,s=t.customAttribute;n===void 0&&(n=[]);n||console.warn('[Radi:Router] Routes should be set as a second parameter');var f={},a=58;47;var h,p,d,m,g=function(t){var n=t.split('/'),e=[],r=[];for(var u=0;u<n.length;u++)a===n[u].charCodeAt(0)?(e.push('([^/]+?)'),r.push(n[u].substr(1))):n[u]!==''&&e.push(n[u]);return[new RegExp('^/'+e.join('/')+'(?:[/])?(?:[?&].*)?$','i'),r]},y=function(t){var n=t.length,e=new Array(n);for(var r=n-1;r>=0;r--)e[r]=g(t[r]);return e},b=function(t){return f.config.errors[t]()},w=function(t){window.location.hash=t;return!0},x=function(t){var n=t;for(var e in t){if(t.hasOwnProperty(e)&&t[e].children){var r=x(t[e].children);for(var u in r)r.hasOwnProperty(u)&&(n[e+u]=r[u])}}return n},R=function(t){if(!f.routes){return null}if(d===t){return m}h||(h=Object.keys(f.routes));p||(p=y(h));var n=!1;for(var e=0;e<p.length;e++){if(p[e][0].test(t)){m=new v(t,p[e],f.routes,h[e]);n=!0;break}}d=t;return!n?{key:null}:m},v=function(t,n,e,r){var u=t.split(/[\?\&]/).slice(1).map(function(t){return t.split('=')}).reduce(function(t,n){var e;return Object.assign(t,(e={}, e[n[0]]=n[1], e))},{}),o=t.match(n[0]);this.path=t;this.key=r;this.query=u;this.cmp=e[r]||{};this.params=this.cmp.data||{};for(var i=0;i<n[1].length;i++)this.params[n[1][i]]=o[i+1]},S=function(){var t=[],n=arguments.length;while(n--)t[n]=arguments[n];return(t.reduce(function(t,n){return n?t.concat(n):t},[]))},j=function(){return location.hash.substr(1)||'/'},A=function(){return decodeURI(location.pathname+location.search)||'/'},T=n.mode==='hash'?'hash':'history',k=T==='hash'?j:A,E=T==='hash'?o(window).on('hashchange',function(){return k()}):o(window).on('popstate',function(){return k()}),q=l(k()).on(E,function(){return k()}),U=i([q,l({params:{},query:{},current:{title:null,tags:[],meta:{}}})],null).map(function(t){var n=t[0],e=t[1];if(!e||!n){return{}}var r=T==='hash'?j():A(),u=R(r)||{};window.scrollTo(0,0);var o=u.cmp&&u.cmp.title,i=n.split('#');c.Title&&c.Title.set(o);return{route:i[0].split(/[\?\&]/)[0],hash:i[1],last:e.active,location:r,params:u.params||{},query:u.query||{},active:u.key||'',current:{title:typeof o==='object'?o:{text:o}||null,tags:u.cmp&&u.cmp.tags||[],meta:u.cmp&&u.cmp.meta||{}}}});s('route',function(t,n){if(T==='history'){t.onclick=function(t){t.preventDefault();U.push(n)};t.href=n;return}t.href='#'+n},{addToElement:!1});s('href',function(t,n){if(T==='history'){n[0]==='/'&&n[1]!=='/'&&(t.onclick=function(t){t.preventDefault();U.push(n)});return n}if(n[0]==='#'){return U.listener(function(t){var e=t.route;return'#'+e+n})}return'#'+n},{allowedTags:['a'],addToElement:!0});function M(t){if(typeof t==='function'){return M(t())}if(typeof t==='object'&&t.default){return M(t.default)}return t}function C(t,n,e){if(t===null&&typeof e==='undefined'){return}var r=f.routes[t]||f.routes[n],u=typeof r==='object'?r.component:r;if((typeof u==='undefined'||typeof u==='number'||!u)&&typeof r==='undefined'){return b(u||404)}if(typeof r.redirect==='string'){return w(r.redirect)}var o=[f.before||null,r.before||null].filter(function(t){return typeof t==='function'});if(o.length>0){var i=function(n,r){var c=o.pop();if(typeof c!=='function'){return n(u)}return c(t,e,function(t){if(typeof t==='undefined'||t===!0){if(o.length>0){return i(n,r)}else{return n(u)}}if(t){if(o.length>0){return i(n,r)}else{return n(t)}}return n(b(403))},U.getRawState())};return new Promise(i)}return u}function P(t){var n=t.placeholder,r=t.waitMs,o=U.state,i=o.route,c=o.active,l=o.last,s=new Promise(function(t){var n=M(C(c,i,l));n instanceof Promise?n.then(t):t(n)});return e(u,{src:s,placeholder:n,waitMs:r})}function O(t){var n='',e=n.split('?').length-1;for(var r in t)typeof t[r]!=='undefined'&&(n=n.concat((!e?'?':'&')+r+'='+t[r]),e+=1);return n}U.push=function(t){t[0]==='/'&&t[1]!=='/'&&(history.pushState(null,null,t),E(A))};U.query=function(t){var n=U.getRawState(),e=n.location.split(/[\?\&]/)[0],r=typeof t==='function'?O(t(n.query)):O(t);U.push(e+r)};U.replace=function(t){t[0]==='/'&&t[1]!=='/'&&(history.replaceState(null,null,t),E(A))};var D=r('Modify Title'),F=l({prefix:null,text:null,suffix:'Radi.js',seperator:' | '},null).on(D,function(t,n){return(Object.assign({},t,n))}),$=function(){this.onUpdate=this.onUpdate.bind(this);F.subscribe(this.onUpdate)};$.prototype.setPrefix=function(t){return D({prefix:t})};$.prototype.setSuffix=function(t){return D({suffix:t})};$.prototype.set=function(t){return D({text:t})};$.prototype.setSeperator=function(t){return D({seperator:t})};$.prototype.onUpdate=function(t){var e=t||{},r=n.title&&n.title.prefix||e.prefix,u=e.text||n.title&&n.title.text||e.text,o=n.title&&n.title.suffix||e.suffix,i=S(r,u,o).join(e.seperator);i&&document.title!==i&&(document.title=i);e.text&&u!==e.text&&this.set(null)};var B=n.beforeEach,N=n.afterEach,z=function(t,e){var r=n.errors&&n.errors[t];if(r){return typeof r==='function'?r:function(){return r}}return e};f={config:{errors:{404:z(404,function(){return e('div',{},'Error 404: Not Found')}),403:z(403,function(){return e('div',{},'Error 403: Forbidden')})}},before:B,after:N,routes:x(n.routes),write:w,Router:P};c.add('Router',function(){return U});c.add('Title',function(){return new $});c.add('RouterBody',function(){return P});return f};typeof window!=='undefined'&&(window.RadiRouter=RadiRouter);export default RadiRouter;export { version }