var version='0.5.0',RadiRouter=function(t,n){var e=t.h,r=t.Await,u=t.Event,o=t.Service,i=t.Store,c=t.customAttribute;n===void 0&&(n=[]);n||console.warn('[Radi:Router] Routes should be set as a second parameter');var s={},l=58;47;var f,a,p,h,d=function(t){var n=t.split('/'),e=[],r=[];for(var u=0;u<n.length;u++)l===n[u].charCodeAt(0)?(e.push('([^/]+?)'),r.push(n[u].substr(1))):n[u]!==''&&e.push(n[u]);return[new RegExp('^/'+e.join('/')+'(?:[/])?(?:[?&].*)?$','i'),r]},m=function(t){var n=t.length,e=new Array(n);for(var r=n-1;r>=0;r--)e[r]=d(t[r]);return e},g=function(t){return s.config.errors[t]()},w=function(t){window.location.hash=t;return!0},y=function(t){var n=t;for(var e in t){if(t.hasOwnProperty(e)&&t[e].children){var r=y(t[e].children);for(var u in r)r.hasOwnProperty(u)&&(n[e+u]=r[u])}}return n},b=function(t){if(p===t){return h}f||(f=Object.keys(s.routes));a||(a=m(f));var n=!1;for(var e=0;e<a.length;e++){if(a[e][0].test(t)){h=new x(t,a[e],s.routes,f[e]);n=!0;break}}p=t;return!n?{key:null}:h},x=function(t,n,e,r){var u=t.split(/[\?\&]/).slice(1).map(function(t){return t.split('=')}).reduce(function(t,n){var e;return Object.assign(t,(e={}, e[n[0]]=n[1], e))},{}),o=t.match(n[0]);this.path=t;this.key=r;this.query=u;this.cmp=e[r]||{};this.params=this.cmp.data||{};for(var i=0;i<n[1].length;i++)this.params[n[1][i]]=o[i+1]},v=function(){var t=[],n=arguments.length;while(n--)t[n]=arguments[n];return(t.reduce(function(t,n){return n?t.concat(n):t},[]))},j=function(){return location.hash.substr(1)||'/'},A=function(){return decodeURI(location.pathname+location.search)||'/'},R=n.mode==='hash'?'hash':'history',k=R==='hash'?new u(window,'hashchange',function(t){return j()})(j()):new u(window,'popstate',function(t){return A()})(A()),E=new i({route:k,params:{},query:{},current:{title:null,tags:[],meta:{}}},null).map(function(t,n){n===void 0&&(n={});var e=R==='hash'?j():A(),r=b(e)||{};window.scrollTo(0,0);var u=r.cmp&&r.cmp.title,i=t.route.split('#');o.Title.set(u);return{route:i[0].split(/[\?\&]/)[0],hash:i[1],last:t.active,location:e,params:r.params||{},query:r.query||{},active:r.key||'',current:{title:typeof u==='object'?u:{text:u}||null,tags:r.cmp&&r.cmp.tags||[],meta:r.cmp&&r.cmp.meta||{}}}});c('route',function(t,n){if(R==='history'){t.onclick=function(t){t.preventDefault();E.push(n)};t.href=n;return}t.href='#'+n},{addToElement:!1});c('href',function(t,n){if(R==='history'){n[0]==='/'&&n[1]!=='/'&&(t.onclick=function(t){t.preventDefault();E.push(n)});return n}if(n[0]==='#'){return E.listener(function(t){var e=t.route;return'#'+e+n})}return'#'+n},{allowedTags:['a'],addToElement:!0});function S(t){if(typeof t==='function'){return S(t())}if(typeof t==='object'&&t.default){return S(t.default)}return t}function q(t,n,e){if(t===null&&typeof e==='undefined'){return}var r=s.routes[t]||s.routes[n],u=typeof r==='object'?r.component:r;if((typeof u==='undefined'||typeof u==='number'||!u)&&typeof r==='undefined'){return g(u||404)}if(typeof r.redirect==='string'){return w(r.redirect)}var o=[s.before||null,r.before||null].filter(function(t){return typeof t==='function'});if(o.length>0){var i=function(n,r){var c=o.pop();if(typeof c!=='function'){return n(u)}return c(t,e,function(t){if(typeof t==='undefined'||t===!0){if(o.length>0){return i(n,r)}else{return n(u)}}if(t){if(o.length>0){return i(n,r)}else{return n(t)}}return n(g(403))},E.get())};return new Promise(i)}return u}function U(t){var n=t.placeholder,u=t.waitMs,o=E.state,i=o.route,c=o.active,s=o.last,l=new Promise(function(t){var n=S(q(c,i,s));n instanceof Promise?n.then(t):t(n)});return e(r,{src:l,placeholder:n,waitMs:u})}function C(t){var n='',e=n.split('?').length-1;for(var r in t)typeof t[r]!=='undefined'&&(n=n.concat((!e?'?':'&')+r+'='+t[r]),e+=1);return n}E.push=function(t){t[0]==='/'&&t[1]!=='/'&&(history.pushState(null,null,t),k.dispatch(A))};E.query=function(t){var n=E.get(),e=n.location.split(/[\?\&]/)[0],r=typeof t==='function'?C(t(n.query)):C(t);E.push(e+r)};E.replace=function(t){t[0]==='/'&&t[1]!=='/'&&(history.replaceState(null,null,t),k.dispatch(A))};var P=new i({prefix:null,text:null,suffix:'Radi.js',seperator:' | '},null),T=function(){this.onUpdate=this.onUpdate.bind(this);P.subscribe(this.onUpdate)};T.prototype.setPrefix=function(t){return P.dispatch(function(t,n){return(Object.assign({},t,{prefix:n}))},t)};T.prototype.setSuffix=function(t){return P.dispatch(function(t,n){return(Object.assign({},t,{suffix:n}))},t)};T.prototype.set=function(t){return P.dispatch(function(t,n){return(Object.assign({},t,{text:n}))},t)};T.prototype.setSeperator=function(t){return P.dispatch(function(t,n){return(Object.assign({},t,{seperator:n}))},t)};T.prototype.onUpdate=function(t){var e=t||{},r=n.title&&n.title.prefix||e.prefix,u=e.text||n.title&&n.title.text||e.text,o=n.title&&n.title.suffix||e.suffix,i=v(r,u,o).join(e.seperator);i&&document.title!==i&&(document.title=i);e.text&&u!==e.text&&this.set(null)};var O=n.beforeEach,D=n.afterEach,F=function(t,e){var r=n.errors&&n.errors[t];if(r){return typeof r==='function'?r:function(){return r}}return e};s={config:{errors:{404:F(404,function(){return e('div',{},'Error 404: Not Found')}),403:F(403,function(){return e('div',{},'Error 403: Forbidden')})}},before:O,after:D,routes:y(n.routes),write:w,Router:U};o.add('Router',function(){return E});o.add('Title',function(){return new T});o.add('RouterBody',function(){return U});return s};window&&(window.RadiRouter=RadiRouter);export default RadiRouter;export { version }