var version='0.5.0',RadiRouter=function(t,n){var e=t.h,r=t.Await,u=t.Event,o=t.Service,i=t.Store,c=t.customAttribute;n===void 0&&(n=[]);n||console.warn('[Radi:Router] Routes should be set as a second parameter');var s={},f=58;47;var a,l,h,p,d=function(t){var n=t.split('/'),e=[],r=[];for(var u=0;u<n.length;u++)f===n[u].charCodeAt(0)?(e.push('([^/]+?)'),r.push(n[u].substr(1))):n[u]!==''&&e.push(n[u]);return[new RegExp('^/'+e.join('/')+'(?:[/])?(?:[?&].*)?$','i'),r]},m=function(t){var n=t.length,e=new Array(n);for(var r=n-1;r>=0;r--)e[r]=d(t[r]);return e},g=function(t){return s.config.errors[t]()},w=function(t){window.location.hash=t;return!0},b=function(t){var n=t;for(var e in t){if(t.hasOwnProperty(e)&&t[e].children){var r=b(t[e].children);for(var u in r)r.hasOwnProperty(u)&&(n[e+u]=r[u])}}return n},y=function(t){if(h===t){return p}a||(a=Object.keys(s.routes));l||(l=m(a));var n=!1;for(var e=0;e<l.length;e++){if(l[e][0].test(t)){p=new x(t,l[e],s.routes,a[e]);n=!0;break}}h=t;return!n?{key:null}:p},x=function(t,n,e,r){var u=this,o=t.split(/[\?\&]/).slice(1).map(function(t){return t.split('=')}).reduce(function(t,n){var e;return Object.assign(t,(e={}, e[n[0]]=n[1], e))},{}),i=t.match(n[0]);this.path=t;this.key=r;this.query=o;this.cmp=e[r]||{};this.params=this.cmp.data||{};for(var c=0;c<n[1].length;c++)u.params[n[1][c]]=i[c+1]},j=function(){var t=[],n=arguments.length;while(n--)t[n]=arguments[n];return(t.reduce(function(t,n){return n?t.concat(n):t},[]))},v=function(){return location.hash.substr(1)||'/'},A=function(){return decodeURI(location.pathname+location.search)||'/'},E=n.mode==='hash'?'hash':'history',R=E==='hash'?new u(window,'hashchange',function(t){return v()})(v()):new u(window,'popstate',function(t){return A()})(A()),S=new i({route:R,params:{},query:{},current:{title:null,tags:[],meta:{}}},null).map(function(t,n){n===void 0&&(n={});var e=E==='hash'?v():A(),r=y(e)||{};window.scrollTo(0,0);var u=r.cmp&&r.cmp.title,i=t.route.split('#');o.Title.set(u);return{route:i[0],hash:i[1],last:t.active,location:e,params:r.params||{},query:r.query||{},active:r.key||'',current:{title:typeof u==='object'?u:{text:u}||null,tags:r.cmp&&r.cmp.tags||[],meta:r.cmp&&r.cmp.meta||{}}}});c('href',function(t,n){if(E==='history'){n[0]==='/'&&n[1]!=='/'&&(t.onclick=function(t){t.preventDefault();history.pushState(null,null,n);R.dispatch(A)});return n}if(n[0]==='#'){return S.listener(function(t){var e=t.route;return'#'+e+n})}return'#'+n},{allowedTags:['a'],addToElement:!0});function k(t){if(typeof t==='function'){return k(t())}if(typeof t==='object'&&t.default){return k(t.default)}return t}function U(t,n){if(t===null&&typeof n==='undefined'){return}var e=s.routes[t],r=typeof e==='object'?e.component:e;if((typeof r==='undefined'||typeof r==='number'||!r)&&typeof e==='undefined'){return g(r||404)}if(typeof e.redirect==='string'){return w(e.redirect)}var u=[s.before||null,e.before||null].filter(function(t){return typeof t==='function'});if(u.length>0){var o=function(e,i){var c=u.pop();if(typeof c!=='function'){return e(r)}return c(t,n,function(t){if(typeof t==='undefined'||t===!0){if(u.length>0){return o(e,i)}else{return e(r)}}if(t){if(u.length>0){return o(e,i)}else{return e(t)}}return e(g(403))},S.get())};return new Promise(o)}return r}function C(t){var n=t.placeholder,u=t.waitMs,o=S.state,i=o.route,c=new Promise(function(t){var n=k(U(i));n instanceof Promise?n.then(t):t(n)});return e(r,{src:c,placeholder:n,waitMs:u})}var P=new i({prefix:null,text:null,suffix:'Radi.js',seperator:' | '},null),T=function(){this.onUpdate=this.onUpdate.bind(this);P.subscribe(this.onUpdate)};T.prototype.setPrefix=function(t){return P.dispatch(function(t,n){return(Object.assign({},t,{prefix:n}))},t)};T.prototype.setSuffix=function(t){return P.dispatch(function(t,n){return(Object.assign({},t,{suffix:n}))},t)};T.prototype.set=function(t){return P.dispatch(function(t,n){return(Object.assign({},t,{text:n}))},t)};T.prototype.setSeperator=function(t){return P.dispatch(function(t,n){return(Object.assign({},t,{seperator:n}))},t)};T.prototype.onUpdate=function(t){var e=t||{},r=n.title&&n.title.prefix||e.prefix,u=e.text||n.title&&n.title.text||e.text,o=n.title&&n.title.suffix||e.suffix,i=j(r,u,o).join(e.seperator);i&&document.title!==i&&(document.title=i);e.text&&u!==e.text&&this.set(null)};var q=n.beforeEach,O=n.afterEach,F=function(t,e){var r=n.errors&&n.errors[t];if(r){return typeof r==='function'?r:function(){return r}}return e};s={config:{errors:{404:F(404,function(){return e('div',{},'Error 404: Not Found')}),403:F(403,function(){return e('div',{},'Error 403: Forbidden')})}},before:q,after:O,routes:b(n.routes),write:w,Router:C};o.add('routerStore',function(){return S});o.add('Title',function(){return new T});o.add('Router',function(){return C});return s};window&&(window.RadiRouter=RadiRouter);export default RadiRouter;export { version }