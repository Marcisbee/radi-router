var version='0.5.0',RadiRouter=function(t,n){var e=t.h,r=t.Event,u=t.Service,o=t.Store,i=t.customAttribute;n===void 0&&(n=[]);n||console.warn('[Radi:Router] Routes should be set as a second parameter');var c={},s=58;47;var f,a,l,p,h=function(t){var n=t.split('/'),e=[],r=[];for(var u=0;u<n.length;u++)s===n[u].charCodeAt(0)?(e.push('([^/]+?)'),r.push(n[u].substr(1))):n[u]!==''&&e.push(n[u]);return[new RegExp('^/'+e.join('/')+'(?:[/])?(?:[?&].*)?$','i'),r]},d=function(t){var n=t.length,e=new Array(n);for(var r=n-1;r>=0;r--)e[r]=h(t[r]);return e},m=function(t){return c.config.errors[t]()},g=function(t){window.location.hash=t;return!0},b=function(t){var n=t;for(var e in t){if(t.hasOwnProperty(e)&&t[e].children){var r=b(t[e].children);for(var u in r)r.hasOwnProperty(u)&&(n[e+u]=r[u])}}return n},w=function(t){if(l===t){return p}f||(f=Object.keys(c.routes));a||(a=d(f));var n=!1;for(var e=0;e<a.length;e++){if(a[e][0].test(t)){p=new y(t,a[e],c.routes,f[e]);n=!0;break}}l=t;return!n?{key:null}:p},y=function(t,n,e,r){var u=this,o=t.split(/[\?\&]/).slice(1).map(function(t){return t.split('=')}).reduce(function(t,n){var e;return Object.assign(t,(e={}, e[n[0]]=n[1], e))},{}),i=t.match(n[0]);this.path=t;this.key=r;this.query=o;this.cmp=e[r]||{};this.params=this.cmp.data||{};for(var c=0;c<n[1].length;c++)u.params[n[1][c]]=i[c+1]},x=function(){var t=[],n=arguments.length;while(n--)t[n]=arguments[n];return(t.reduce(function(t,n){return n?t.concat(n):t},[]))},j=function(){return location.hash.substr(1)||'/'},v=new r(window,'hashchange',function(t){return({hash:j()})}),E=new o({route:v({hash:j()}).map(function(t){var n=t.hash;return n}),params:{},query:{},current:{title:null,tags:[],meta:{}}}).map(function(t,n){n===void 0&&(n={});var e=window.location.hash.substr(1)||'/',r=w(e)||{};window.scrollTo(0,0);var o=r.cmp&&r.cmp.title,i=t.route.split('#');u.Title.set(o);return{route:i[0],hash:i[1],last:t.active,location:e,params:r.params||{},query:r.query||{},active:r.key||'',current:{title:typeof o==='object'?o:{text:o}||null,tags:r.cmp&&r.cmp.tags||[],meta:r.cmp&&r.cmp.meta||{}}}});i('href',function(t,n){if(n[0]==='#'){return E.listener(function(t){var e=t.route;return'#'+e+n})}return'#'+n},{allowedTags:['a'],addToElement:!0});function R(t){if(typeof t==='function'){return R(t())}if(typeof t==='object'&&t.default){return R(t.default)}return t}function A(t,n){if(t===null&&typeof n==='undefined'){return}var e=c.routes[t],r=typeof e==='object'?e.component:e;if((typeof r==='undefined'||typeof r==='number'||!r)&&typeof e==='undefined'){return m(r||404)}if(typeof e.redirect==='string'){return g(e.redirect)}var u=[c.before||null,e.before||null].filter(function(t){return typeof t==='function'});if(u.length>0){var o=function(e,i){var c=u.pop();if(typeof c!=='function'){return e(r)}return c(t,n,function(t){if(typeof t==='undefined'||t===!0){if(u.length>0){return o(e,i)}else{return e(r)}}if(t){if(u.length>0){return o(e,i)}else{return e(t)}}return e(m(403))},E.get())};return new Promise(o)}return r}function S(t){var n=t.placeholder,r=t.waitMs,u=E.state,o=u.route,i=new Promise(function(t){var n=R(A(o));n instanceof Promise?n.then(t):t(n)});return e('await',{src:i,placeholder:n,waitMs:r})}var U=new o({prefix:null,text:null,suffix:'Radi.js',seperator:' | '}),k=function(t,n){return(Object.assign({},t,{prefix:n}))},C=function(t,n){return(Object.assign({},t,{suffix:n}))},P=function(t,n){return(Object.assign({},t,{text:n}))},T=function(t,n){return(Object.assign({},t,{seperator:n}))},q=function(){this.onUpdate=this.onUpdate.bind(this);U.subscribe(this.onUpdate)};q.prototype.setPrefix=function(t){return U.dispatch(k,t)};q.prototype.setSuffix=function(t){return U.dispatch(C,t)};q.prototype.set=function(t){return U.dispatch(P,t)};q.prototype.setSeperator=function(t){return U.dispatch(T,t)};q.prototype.onUpdate=function(t){var e=t||{},r=n.title&&n.title.prefix||e.prefix,u=e.text||n.title&&n.title.text||e.text,o=n.title&&n.title.suffix||e.suffix,i=x(r,u,o).join(e.seperator);i&&document.title!==i&&(document.title=i);e.text&&u!==e.text&&this.set(null)};var O=n.beforeEach,F=n.afterEach,M=function(t,e){var r=n.errors&&n.errors[t];if(r){return typeof r==='function'?r:function(){return r}}return e};c={config:{errors:{404:M(404,function(){return e('div',{},'Error 404: Not Found')}),403:M(403,function(){return e('div',{},'Error 403: Forbidden')})}},before:O,after:F,routes:b(n.routes),write:g,Router:S};u.add('routerStore',function(){return E});u.add('Title',function(){return new q});u.add('Router',function(){return S});return c};window&&(window.RadiRouter=RadiRouter);export default RadiRouter;export { version }